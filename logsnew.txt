SPECTRAL_USE_POINTER_MASK=0 NUM_ITERATIONS=200 VAL_LOSS_EVERY=0 SCOPE_LOG_EVERY=100 bash run.sh

{"tag": "SCOPE_STATS", "step": 50, "train_loss": 5.658390998840332, "sliding_window_blocks": 4, "pointer_mask": {"enabled": false, "half_blocks": 0, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": true, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4246, "kv_unique_blocks": {"mean": null, "p50": null, "p90": null, "min": null, "max": null}, "ptr_outside_local_frac": {"mean": 0.00511067733168602, "min": 0.0, "max": 0.01513671875}, "ptr_center_block0_frac": {"mean": 0.0192057304084301, "min": 0.01123046875, "max": 0.02587890625}, "ptr_center_block0_frac_excl": {"mean": 0.0014112902572378516, "min": 0.0, "max": 0.004032257944345474}, "ptr_center_docstart_frac": {"mean": 0.3941406309604645, "min": 0.263671875, "max": 0.5048828125}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.6333898305892944, "min": 0.5812888145446777, "max": 0.6821855306625366}, "reg": {"omega": 2.365395639775114e-12, "entropy": 1.6070995911832142e-07, "delta_edge": 2.8642623874475248e-05, "zero_mean": 0.0001563515397720039, "total": 0.00018515487317927182}, "delta_tokens_hist": [0.07776693254709244, 0.40774741768836975, 0.15498048067092896, 0.15029297769069672, 0.10657552629709244, 0.05657552555203438, 0.04368489980697632, 0.002376302145421505, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4855143427848816, 0.15498048067092896, 0.15029297769069672, 0.10657552629709244, 0.05657552555203438, 0.04368489980697632, 0.002376302145421505, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0192057304084301, 0.005859375465661287, 0.010156250558793545, 0.02727864682674408, 0.0660807341337204, 0.1214192807674408, 0.25322267413139343, 0.49677735567092896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [], "ptr_extra_sum_hist": []}

{"tag": "SCOPE_STATS", "step": 100, "train_loss": 5.050104141235352, "sliding_window_blocks": 7, "pointer_mask": {"enabled": false, "half_blocks": 0, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": true, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4399, "kv_unique_blocks": {"mean": null, "p50": null, "p90": null, "min": null, "max": null}, "ptr_outside_local_frac": {"mean": 0.008463541977107525, "min": 0.00146484375, "max": 0.02392578125}, "ptr_center_block0_frac": {"mean": 0.02727864682674408, "min": 0.02099609375, "max": 0.04052734375}, "ptr_center_block0_frac_excl": {"mean": 0.00786290317773819, "min": 0.00352822570130229, "max": 0.019153226166963577}, "ptr_center_docstart_frac": {"mean": 0.43649089336395264, "min": 0.3720703125, "max": 0.560546875}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.6018255352973938, "min": 0.5624417066574097, "max": 0.6387277245521545}, "reg": {"omega": 4.06512063594322e-12, "entropy": 3.473416256838391e-07, "delta_edge": 2.374799078097567e-05, "zero_mean": 0.003061792114749551, "total": 0.003085887525230646}, "delta_tokens_hist": [0.1140950545668602, 0.2650716304779053, 0.23180340230464935, 0.17076823115348816, 0.0620117224752903, 0.05888672173023224, 0.07545573264360428, 0.02190755307674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.37916669249534607, 0.23180340230464935, 0.17076823115348816, 0.0620117224752903, 0.05888672173023224, 0.07545573264360428, 0.02190755307674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.02727864682674408, 0.005013021174818277, 0.01315104216337204, 0.02369791828095913, 0.06337890774011612, 0.12916667759418488, 0.24394533038139343, 0.4943685233592987, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [], "ptr_extra_sum_hist": []}

{"tag": "SCOPE_STATS", "step": 150, "train_loss": 4.567113399505615, "sliding_window_blocks": 11, "pointer_mask": {"enabled": false, "half_blocks": 0, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": true, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4553, "kv_unique_blocks": {"mean": null, "p50": null, "p90": null, "min": null, "max": null}, "ptr_outside_local_frac": {"mean": 0.007584635633975267, "min": 0.0048828125, "max": 0.0107421875}, "ptr_center_block0_frac": {"mean": 0.0078125, "min": 0.0078125, "max": 0.0078125}, "ptr_center_block0_frac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.6176106929779053, "min": 0.5146484375, "max": 0.7236328125}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.504818320274353, "min": 0.07665364444255829, "max": 0.6459702849388123}, "reg": {"omega": 1.514735559204894e-11, "entropy": 2.5431345420656726e-05, "delta_edge": 3.0206994779291563e-05, "zero_mean": 0.000805004732683301, "total": 0.0008606431074440479}, "delta_tokens_hist": [0.21855470538139343, 0.19521485269069672, 0.08710937947034836, 0.07529297471046448, 0.06845703721046448, 0.09072265774011612, 0.12220052629709244, 0.14244791865348816, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.41376954317092896, 0.08710937947034836, 0.07529297471046448, 0.06845703721046448, 0.09072265774011612, 0.12220052629709244, 0.14244791865348816, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0078125, 0.01276041753590107, 0.01067708432674408, 0.03984375298023224, 0.06946615129709244, 0.10944011062383652, 0.2570638060569763, 0.49293622374534607, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [], "ptr_extra_sum_hist": []}

{"tag": "SCOPE_STATS", "step": 200, "train_loss": 4.384336948394775, "sliding_window_blocks": 14, "pointer_mask": {"enabled": false, "half_blocks": 0, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": true, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4706, "kv_unique_blocks": {"mean": null, "p50": null, "p90": null, "min": null, "max": null}, "ptr_outside_local_frac": {"mean": 0.08313802629709244, "min": 0.033203125, "max": 0.1240234375}, "ptr_center_block0_frac": {"mean": 0.09173177927732468, "min": 0.05224609375, "max": 0.1201171875}, "ptr_center_block0_frac_excl": {"mean": 0.07264784723520279, "min": 0.033770158886909485, "max": 0.10080644488334656}, "ptr_center_docstart_frac": {"mean": 0.541015625, "min": 0.466796875, "max": 0.6220703125}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.580671489238739, "min": 0.3903612494468689, "max": 0.6645945310592651}, "reg": {"omega": 1.521915059254919e-11, "entropy": 6.539564310514834e-06, "delta_edge": 2.4770004529273137e-05, "zero_mean": 0.00015663310477975756, "total": 0.00018794267089106143}, "delta_tokens_hist": [0.19918620586395264, 0.16009114682674408, 0.08118490129709244, 0.10029297322034836, 0.07249349355697632, 0.09029948711395264, 0.15664063394069672, 0.1398112028837204, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.3592773675918579, 0.08118490129709244, 0.10029297322034836, 0.07249349355697632, 0.09029948711395264, 0.15664063394069672, 0.1398112028837204, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.09173177927732468, 0.008691406808793545, 0.014876303263008595, 0.02828776277601719, 0.05374349281191826, 0.08964844048023224, 0.21813152730464935, 0.49488934874534607, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [], "ptr_extra_sum_hist": []}


SPECTRAL_USE_POINTER_MASK=1 SPECTRAL_POINTER_BUDGET_IS_TOTAL=0 NUM_ITERATIONS=200 VAL_LOSS_EVERY=0 SCOPE_LOG_EVERY=50 bash run.sh

{"tag": "SCOPE_STATS", "step": 50, "train_loss": 5.776195526123047, "sliding_window_blocks": 4, "pointer_mask": {"enabled": true, "half_blocks": 4, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": false, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4246, "kv_unique_blocks": {"mean": 6.124153645833333, "p50": 5, "p90": 12, "min": 1, "max": 17}, "ptr_outside_local_frac": {"mean": 0.006510416977107525, "min": 0.0, "max": 0.02880859375}, "ptr_center_block0_frac": {"mean": 0.0187174491584301, "min": 0.01171875, "max": 0.0263671875}, "ptr_center_block0_frac_excl": {"mean": 0.001276881666854024, "min": 0.0, "max": 0.005040322430431843}, "ptr_center_docstart_frac": {"mean": 0.38880211114883423, "min": 0.25439453125, "max": 0.57373046875}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.563941240310669, "min": 0.36794376373291016, "max": 0.6362758874893188}, "reg": {"omega": 5.4410269692550806e-12, "entropy": 3.0620044526585843e-06, "delta_edge": 3.293202098575421e-05, "zero_mean": 0.00019372260430827737, "total": 0.00022971663565840572}, "delta_tokens_hist": [0.11705730110406876, 0.4262695610523224, 0.12636719644069672, 0.125, 0.07848307490348816, 0.05000000447034836, 0.06669922173023224, 0.01012369804084301, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.5433268547058105, 0.12636719644069672, 0.125, 0.07848307490348816, 0.05000000447034836, 0.06669922173023224, 0.01012369804084301, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0187174491584301, 0.005533854477107525, 0.010384115390479565, 0.02786458469927311, 0.06595052778720856, 0.12154948711395264, 0.2532552182674408, 0.4967448115348816, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}


{"tag": "SCOPE_STATS", "step": 100, "train_loss": 5.1153435707092285, "sliding_window_blocks": 7, "pointer_mask": {"enabled": true, "half_blocks": 4, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": false, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4399, "kv_unique_blocks": {"mean": 5.967643229166667, "p50": 5, "p90": 12, "min": 1, "max": 21}, "ptr_outside_local_frac": {"mean": 0.008691406808793545, "min": 0.0, "max": 0.04052734375}, "ptr_center_block0_frac": {"mean": 0.02278645895421505, "min": 0.0126953125, "max": 0.04638671875}, "ptr_center_block0_frac_excl": {"mean": 0.006720430683344603, "min": 0.0, "max": 0.027721773833036423}, "ptr_center_docstart_frac": {"mean": 0.38245445489883423, "min": 0.2666015625, "max": 0.59033203125}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.5157784223556519, "min": 0.2932145893573761, "max": 0.6518997550010681}, "reg": {"omega": 2.1815734982388868e-11, "entropy": 8.261606126325205e-06, "delta_edge": 3.143554931739345e-05, "zero_mean": 0.0027847150340676308, "total": 0.0028244121931493282}, "delta_tokens_hist": [0.13792318105697632, 0.3734700679779053, 0.20253907144069672, 0.11435547471046448, 0.04550781473517418, 0.03242187574505806, 0.06979166716337204, 0.02399088628590107, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.5113932490348816, 0.20253907144069672, 0.11435547471046448, 0.04550781473517418, 0.03242187574505806, 0.06979166716337204, 0.02399088628590107, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.02278645895421505, 0.006250000558793545, 0.01396484486758709, 0.02529297024011612, 0.0625, 0.12779948115348816, 0.24524740874767303, 0.4961588680744171, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}


{"tag": "SCOPE_STATS", "step": 150, "train_loss": 4.605681419372559, "sliding_window_blocks": 11, "pointer_mask": {"enab
led": true, "half_blocks": 4, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0},
 "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": false, "budget_temp":
1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": fa
lse, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4553, "kv_unique_blocks": {"mean": 4.416861979166667, "p50": 4, "p90
": 8, "min": 1, "max": 15}, "ptr_outside_local_frac": {"mean": 0.004069010727107525, "min": 0.0, "max": 0.0078125}, "ptr
_center_block0_frac": {"mean": 0.0078125, "min": 0.0078125, "max": 0.0078125}, "ptr_center_block0_frac_excl": {"mean": 0
.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.5287435054779053, "min": 0.3740234375, "max": 0.6181
640625}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.45734915137290955, "mi
n": 0.03733069822192192, "max": 0.6369011998176575}, "reg": {"omega": 4.829765060110347e-11, "entropy": 3.18448946927674
1e-05, "delta_edge": 3.130063123535365e-05, "zero_mean": 0.0006281533860601485, "total": 0.0006912989774718881}, "delta_
tokens_hist": [0.19342449307441711, 0.32734376192092896, 0.0986328199505806, 0.08769531548023224, 0.07311198115348816, 0
.0595703162252903, 0.10406901687383652, 0.0561523474752903, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist"
: [0.5207682847976685, 0.0986328199505806, 0.08769531548023224, 0.07311198115348816, 0.0595703162252903, 0.10406901687383652, 0.0561523474752903, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0078125, 0.011621094308793545, 0.01181640662252903, 0.03798828274011612, 0.06708984822034836, 0.11367188394069672, 0.2559570372104645, 0.4940429925918579, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}

{"tag": "SCOPE_STATS", "step": 200, "train_loss": 4.4236369132995605, "sliding_window_blocks": 14, "pointer_mask": {"ena
bled": true, "half_blocks": 4, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}
, "pointer_cfg": {"local_blocks": 12, "half_blocks_max": 4, "budget_blocks": 8, "budget_is_total": false, "budget_temp":
 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": f
alse, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4706, "kv_unique_blocks": {"mean": 7.222721354166667, "p50": 5, "p9
0": 14, "min": 1, "max": 32}, "ptr_outside_local_frac": {"mean": 0.0504557304084301, "min": 0.001953125, "max": 0.120605
46875}, "ptr_center_block0_frac": {"mean": 0.0628255233168602, "min": 0.01513671875, "max": 0.1318359375}, "ptr_center_b
lock0_frac_excl": {"mean": 0.04650537669658661, "min": 0.0005040322430431843, "max": 0.1088709682226181}, "ptr_center_do
cstart_frac": {"mean": 0.4511719048023224, "min": 0.3193359375, "max": 0.62744140625}, "ptr_radius0_frac": {"mean": 0.0,
 "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.5262870192527771, "min": 0.2249327301979065, "max": 0.6734092235
565186}, "reg": {"omega": 5.219323584437774e-11, "entropy": 8.466550752928015e-06, "delta_edge": 2.5550871214363724e-05,
 "zero_mean": 6.387139728758484e-05, "total": 9.788886382011697e-05}, "delta_tokens_hist": [0.1580403745174408, 0.285937
51788139343, 0.13300782442092896, 0.10738933086395264, 0.07041016221046448, 0.06015625223517418, 0.10797526687383652, 0.
07708333432674408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.44397789239883423, 0.133007824420928
96, 0.10738933086395264, 0.07041016221046448, 0.06015625223517418, 0.10797526687383652, 0.07708333432674408, 0.0, 0.0, 0
.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0628255233168602, 0.007845052517950535, 0.01588541828095913,
0.03033854253590107, 0.05540364980697632, 0.1035156324505806, 0.2285156399011612, 0.4956705868244171, 0.0, 0.0, 0.0, 0.0
, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
, 0.0, 1.0]}


SPECTRAL_POINTER_BUDGET_IS_TOTAL=1 \ SPECTRAL_POINTER_LOCAL_BLOCKS=2 \ SPECTRAL_M=2 \ SPECTRAL_POINTER_BUDGET_BLOCKS=64 \ SPECTRAL_POINTER_HALF_BLOCKS=8 \ NUM_ITERATIONS=200 VAL_LOSS_EVERY=0 SCOPE_LOG_EVERY=50 \ bash run.sh

{"tag": "SCOPE_STATS", "step": 50, "train_loss": 5.771367073059082, "sliding_window_blocks": 4, "pointer_mask": {"enabled": true, "half_blocks": 8, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 2, "half_blocks_max": 8, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4246, "kv_unique_blocks": {"mean": 5.325716145833334, "p50": 4, "p90": 11, "min": 1, "max": 17}, "ptr_outside_local_frac": {"mean": 0.21057943999767303, "min": 0.07080078125, "max": 0.33837890625}, "ptr_center_block0_frac": {"mean": 0.01888020895421505, "min": 0.01123046875, "max": 0.02587890625}, "ptr_center_block0_frac_excl": {"mean": 0.0014448924921453, "min": 0.0, "max": 0.005040322430431843}, "ptr_center_docstart_frac": {"mean": 0.38919273018836975, "min": 0.2529296875, "max": 0.5751953125}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.5675907135009766, "min": 0.3691553473472595, "max": 0.6421347856521606}, "reg": {"omega": 5.221121278375929e-12, "entropy": 3.0301355309347855e-06, "delta_edge": 3.2810610719025135e-05, "zero_mean": 0.0002673849812708795, "total": 0.000303225708194077}, "delta_tokens_hist": [0.1118164137005806, 0.4295247495174408, 0.12991537153720856, 0.12314453721046448, 0.0805664137005806, 0.04886068031191826, 0.06689453125, 0.009277344681322575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.5413411855697632, 0.12991537153720856, 0.12314453721046448, 0.0805664137005806, 0.04886068031191826, 0.06689453125, 0.009277344681322575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.01888020895421505, 0.005501302424818277, 0.010286458767950535, 0.02783203311264515, 0.06595052778720856, 0.12154948711395264, 0.25322267413139343, 0.49677735567092896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}

{"tag": "SCOPE_STATS", "step": 100, "train_loss": 5.151045322418213, "sliding_window_blocks": 7, "pointer_mask": {"enabl
ed": true, "half_blocks": 8, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0},
"pointer_cfg": {"local_blocks": 2, "half_blocks_max": 8, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 1.
0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": fals
e, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4399, "kv_unique_blocks": {"mean": 5.208138020833333, "p50": 4, "p90":
 11, "min": 1, "max": 22}, "ptr_outside_local_frac": {"mean": 0.22236329317092896, "min": 0.07763671875, "max": 0.338867
1875}, "ptr_center_block0_frac": {"mean": 0.02545573003590107, "min": 0.01220703125, "max": 0.04443359375}, "ptr_center_
block0_frac_excl": {"mean": 0.008098118007183075, "min": 0.0, "max": 0.027217742055654526}, "ptr_center_docstart_frac":
{"mean": 0.41468101739883423, "min": 0.26708984375, "max": 0.58349609375}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0,
 "max": 0.0}, "pi_entropy_mean": {"mean": 0.4554028809070587, "min": 0.16528327763080597, "max": 0.6264480352401733}, "r
eg": {"omega": 2.0408646994596324e-11, "entropy": 3.085474600084126e-05, "delta_edge": 2.8198526706546545e-05, "zero_mea
n": 0.04005872458219528, "total": 0.0401177816092968}, "delta_tokens_hist": [0.11907552927732468, 0.32613933086395264, 0
.21731771528720856, 0.1315104216337204, 0.04765625298023224, 0.0423177108168602, 0.08450521528720856, 0.0314778648316860
2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4452148675918579, 0.21731771528720856, 0.13151042163
37204, 0.04765625298023224, 0.0423177108168602, 0.08450521528720856, 0.03147786483168602, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
0.0, 0.0], "ptr_center_blocks_hist": [0.02545573003590107, 0.005924479570239782, 0.01360677182674408, 0.0235677100718021
4, 0.06263021379709244, 0.1277669370174408, 0.24550782144069672, 0.4955403804779053, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
 "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}

{"tag": "SCOPE_STATS", "step": 150, "train_loss": 4.6237664222717285, "sliding_window_blocks": 11, "pointer_mask": {"ena
bled": true, "half_blocks": 8, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}
, "pointer_cfg": {"local_blocks": 2, "half_blocks_max": 8, "budget_blocks": 64, "budget_is_total": true, "budget_temp":
1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": fa
lse, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4553, "kv_unique_blocks": {"mean": 3.6952473958333334, "p50": 3, "p9
0": 7, "min": 1, "max": 15}, "ptr_outside_local_frac": {"mean": 0.22796225547790527, "min": 0.078125, "max": 0.352050781
25}, "ptr_center_block0_frac": {"mean": 0.0078125, "min": 0.0078125, "max": 0.0078125}, "ptr_center_block0_frac_excl": {
"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.5679362416267395, "min": 0.3974609375, "max
": 0.75244140625}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.466515332460
40344, "min": 0.1477619707584381, "max": 0.6208592057228088}, "reg": {"omega": 5.551349657739735e-11, "entropy": 2.77461
3312794827e-05, "delta_edge": 2.9734343115705997e-05, "zero_mean": 0.0002151763328583911, "total": 0.0002726568491198122
5}, "delta_tokens_hist": [0.20950521528720856, 0.2671875059604645, 0.08499349653720856, 0.08492839336395264, 0.068750001
49011612, 0.06858724355697632, 0.11959636211395264, 0.09645182639360428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta
_blocks_hist": [0.47669273614883423, 0.08499349653720856, 0.08492839336395264, 0.06875000149011612, 0.06858724355697632,
 0.11959636211395264, 0.09645182639360428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0078125
, 0.01227213628590107, 0.01116536557674408, 0.03880208358168602, 0.06744792312383652, 0.11250000447034836, 0.25686851143
836975, 0.493131548166275, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.
0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}

{"tag": "SCOPE_STATS", "step": 200, "train_loss": 4.440613746643066, "sliding_window_blocks": 14, "pointer_mask": {"enabled": true, "half_blocks": 8, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 2, "half_blocks_max": 8, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 1.0, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": false, "k": 0, "tau": 1.0}}, "delta_star_max_active": 4706, "kv_unique_blocks": {"mean": 6.712630208333334, "p50": 4, "p90": 15, "min": 1, "max": 37}, "ptr_outside_local_frac": {"mean": 0.29137369990348816, "min": 0.08642578125, "max": 0.482421875}, "ptr_center_block0_frac": {"mean": 0.06279297173023224, "min": 0.01416015625, "max": 0.1328125}, "ptr_center_block0_frac_excl": {"mean": 0.045698925852775574, "min": 0.002016128972172737, "max": 0.11189515888690948}, "ptr_center_docstart_frac": {"mean": 0.47047528624534607, "min": 0.30029296875, "max": 0.7001953125}, "ptr_radius0_frac": {"mean": 0.0, "min": 0.0, "max": 0.0}, "pi_entropy_mean": {"mean": 0.5438440442085266, "min": 0.3822852671146393, "max": 0.6532506942749023}, "reg": {"omega": 5.937630942476346e-11, "entropy": 3.746294623852009e-06, "delta_edge": 2.4068303901003674e-05, "zero_mean": 6.547792145283893e-05, "total": 9.329258318757638e-05}, "delta_tokens_hist": [0.17845052480697632, 0.24775391817092896, 0.1077473983168602, 0.11048177629709244, 0.07955729216337204, 0.07522787153720856, 0.11331380903720856, 0.08746745437383652, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4262044429779053, 0.1077473983168602, 0.11048177629709244, 0.07955729216337204, 0.07522787153720856, 0.11331380903720856, 0.08746745437383652, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.06279297173023224, 0.00804036483168602, 0.01572265662252903, 0.02958984486758709, 0.0568033866584301, 0.1040039137005806, 0.2277018278837204, 0.4953450858592987, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0], "ptr_extra_sum_hist": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]}

SPECTRAL_TEACHER_LEN=16384 SPECTRAL_TEACHER_NCE_NEG=2 SPECTRAL_POINTER_BUDGET_TEMP=0.5 SPECTRAL_POINTER_BUDGET_BLOCKS=64 SPECTRAL_POINTER_LOCAL_BLOCKS=6 SPECTRAL_POINTER_HALF_BLOCKS=2 SPECTRAL_M=9 SPECTRAL_GUMBEL_TOPK=1 SPECTRAL_GUMBEL_TOPK_K=1 SPECTRAL_GUMBEL_TOPK_TAU=1.0 SPECTRAL_TEACHER=1 SPECTRAL_TEACHER_LAMBDA_COV=1 SPECTRAL_TEACHER_LAMBDA_BUDGET=0.1 SPECTRAL_TEACHER_NCE=1 SPECTRAL_TEACHER_LAMBDA_NCE=0.1 SPECTRAL_POINTER_RADIUS_MODE=pi FLEXATTN_DYNAMO_DISABLE=1 FLEXATTN_COMPILE=1 SPECTRAL_POINTER_SCHEDULE=0 NUM_ITERATIONS=1000 VAL_LOSS_EVERY=0 SEED=1337 TRAIN_SEQ_LEN=65536 VAL_SEQ_LEN=131072 SPECTRAL_QK_AUG_ALIGN=32 NEEDLE_EVAL=1 NEEDLE_DISTANCES=4096,8192,16384,32768, NEEDLE_SAMPLES_PER_DISTANCE=8 NEEDLE_ANCHOR_LEN=4 NEEDLE_VALUE_LEN=8 NEEDLE_SEQ_LEN=131072 SCOPE_LOG_EVERY=100 bash run.sh


{"tag": "SCOPE_STATS", "step": 100, "train_loss": 5.858392715454102, "sliding_window_blocks": 2, "pointer_mask": {"enabled": true, "half_blocks": 2, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 7238, "kv_unique_blocks": {"mean": 5.672216796875, "p50": 6, "p90": 9, "min": 1, "max": 21}, "ptr_outside_local_frac": {"mean": 0.12094365805387497, "min": 0.0064561632461845875, "max": 0.1954752653837204}, "ptr_center_block0_frac": {"mean": 0.007660590577870607, "min": 0.0035264757461845875, "max": 0.0111219622194767}, "ptr_center_block0_frac_excl": {"mean": 0.003116798121482134, "min": 0.00019138233619742095, "max": 0.005249343812465668}, "ptr_center_docstart_frac": {"mean": 0.4380461573600769, "min": 0.254692941904068, "max": 0.5567762851715088}, "ptr_radius0_frac": {"mean": 0.9380064606666565, "min": 0.9358181357383728, "max": 0.9393717646598816}, "pi_entropy_mean": {"mean": 1.0485507249832153, "min": 0.05215374380350113, "max": 1.9450072050094604}, "reg": {"omega": 5.704708580522855e-11, "entropy": 0.00020135380327701569, "delta_edge": 3.6231547710485756e-05, "zero_mean": 0.5804001688957214, "total": 0.5806377530097961}, "delta_tokens_hist": [0.18452510237693787, 0.29947733879089355, 0.09714807569980621, 0.07901656627655029, 0.06186342611908913, 0.07000325620174408, 0.0642596185207367, 0.14370658993721008, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4840024411678314, 0.09714807569980621, 0.07901656627655029, 0.06186342611908913, 0.07000325620174408, 0.0642596185207367, 0.14370658993721008, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.00766059011220932, 0.0013183593982830644, 0.0027416087687015533, 0.0049424911849200726, 0.020666955038905144, 0.028457753360271454, 0.06386718899011612, 0.12217701226472855, 0.2492639571428299, 0.4989040791988373, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9380063414573669, 0.024862557649612427, 0.03713107481598854], "ptr_extra_sum_hist": [0.4420573115348816, 0.22376303374767303, 0.33417969942092896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 200, "train_loss": 4.321084022521973, "sliding_window_blocks": 3, "pointer_mask": {"enabled": true, "half_blocks": 2, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 10412, "kv_unique_blocks": {"mean": 4.78671875, "p50": 4, "p90": 8, "min": 1, "max": 17}, "ptr_outside_local_frac": {"mean": 0.11027923226356506, "min": 0.02400716207921505, "max": 0.1312120258808136}, "ptr_center_block0_frac": {"mean": 0.003150318516418338, "min": 0.002902560867369175, "max": 0.00341796875}, "ptr_center_block0_frac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.5938006639480591, "min": 0.4717610776424408, "max": 0.6446940302848816}, "ptr_radius0_frac": {"mean": 0.9383174777030945, "min": 0.9366862177848816, "max": 0.939805805683136}, "pi_entropy_mean": {"mean": 0.7750499248504639, "min": 0.02745142951607704, "max": 1.8958697319030762}, "reg": {"omega": 8.050041189200385e-11, "entropy": 0.000245930248638615, "delta_edge": 2.9964823625050485e-05, "zero_mean": 0.028651433065533638, "total": 0.028927329927682877}, "delta_tokens_hist": [0.295146107673645, 0.13008534908294678, 0.04590386152267456, 0.06715856492519379, 0.06056857481598854, 0.05817418918013573, 0.08220305293798447, 0.124620221555233, 0.13614004850387573, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4252314865589142, 0.04590386152267456, 0.06715856492519379, 0.06056857481598854, 0.05817418918013573, 0.08220305293798447, 0.124620221555233, 0.13614004850387573, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.003150318283587694, 0.0007559317164123058, 0.004967809654772282, 0.007915581576526165, 0.021632667630910873, 0.026358144357800484, 0.06501193344593048, 0.12020760774612427, 0.25, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9383174180984497, 0.024612991139292717, 0.03706958889961243], "ptr_extra_sum_hist": [0.44485679268836975, 0.2215169370174408, 0.33362632989883423, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}

{"tag": "SCOPE_STATS", "step": 300, "train_loss": 4.068577289581299, "sliding_window_blocks": 5, "pointer_mask": {"enabl
ed": true, "half_blocks": 2, "global_blocks": 2}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0},
"pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 13586, "kv_unique_blocks": {"mean": 5.919514973958333, "p50": 6, "p90": 10, "min": 1, "max": 21}, "ptr_outside_local_frac": {"mean": 0.19253654778003693, "min": 0.122938372194767, "max": 0.2153862863779068}, "ptr_center_block0_frac": {"mean": 0.0030924479942768812, "min": 0.002685546875, "max": 0.00341796875}, "ptr_center_block0_frac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.5365740656852722, "min": 0.4670681357383728, "max": 0.590087890625}, "ptr_radius0_frac": {"mean": 0.9385634660720825, "min": 0.937744140625, "max": 0.9398329257965088}, "pi_entropy_mean": {"mean": 0.6314946413040161, "min": 0.035491518676280975, "max": 1.1766564846038818}, "reg": {"omega": 9.944607637368819e-11, "entropy": 0.0002079474797938019, "delta_edge": 2.60097804130055e-05, "zero_mean": 0.007397797890007496, "total": 0.007631754968315363}, "delta_tokens_hist": [0.31577327847480774, 0.10268192738294601, 0.026088686659932137, 0.046160660684108734, 0.0835774689912796, 0.056669559329748154, 0.05454643815755844, 0.08097511529922485, 0.2335268259048462, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.41845521330833435, 0.026088686659932137, 0.046160660684108734, 0.0835774689912796, 0.056669559329748154, 0.05454643815755844, 0.08097511529922485, 0.2335268259048462, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.0030924477614462376, 0.0008138020639307797, 0.004947916604578495, 0.014406105503439903, 0.007989727891981602, 0.03125, 0.06663953512907028, 0.13351598381996155, 0.2385289967060089, 0.4988154470920563, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.938563346862793, 0.02493489533662796, 0.03650173544883728], "ptr_extra_sum_hist": [0.44707033038139343, 0.22441408038139343, 0.3285156488418579, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}

{"tag": "SCOPE_STATS", "step": 400, "train_loss": 3.8515830039978027, "sliding_window_blocks": 6, "pointer_mask": {"enabled": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 16761, "kv_unique_blocks": {"mean": 6.271793619791667, "p50": 7, "p90": 10, "min": 1, "max": 19}, "ptr_outside_local_frac": {"mean": 0.2606807351112366, "min": 0.2059190571308136, "max": 0.3235677182674408}, "ptr_center_block0_frac": {"mean": 0.016144026070833206, "min": 0.011990017257630825, "max": 0.0195583775639534}, "ptr_center_block0_frac_excl": {"mean": 0.010952538810670376, "min": 0.006589020136743784, "max": 0.01397091057151556}, "ptr_center_docstart_frac": {"mean": 0.49187102913856506, "min": 0.4281412661075592, "max": 0.545030415058136}, "ptr_radius0_frac": {"mean": 0.9386248588562012, "min": 0.93701171875, "max": 0.9413520097732544}, "pi_entropy_mean": {"mean": 0.6247450709342957, "min": 0.40314236283302307, "max": 0.8901308178901672}, "reg": {"omega": 1.0594365662530691e-10, "entropy": 0.00016375443374272436, "delta_edge": 2.2242315026232973e-05, "zero_mean": 0.0056232125498354435, "total": 0.00580920884385705}, "delta_tokens_hist": [0.31178203225135803, 0.09587492793798447, 0.019337745383381844, 0.036221425980329514, 0.10121165961027145, 0.05113751441240311, 0.05198386684060097, 0.07046440988779068, 0.1863878071308136, 0.07559859752655029, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4076569676399231, 0.019337745383381844, 0.036221425980329514, 0.10121165961027145, 0.05113751441240311, 0.05198386684060097, 0.07046440988779068, 0.1863878071308136, 0.07559859752655029, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.016144024208188057, 0.0012261284282431006, 0.002376302145421505, 0.004493996035307646, 0.008181423880159855, 0.032306134700775146, 0.060271989554166794, 0.12946686148643494, 0.260233998298645, 0.48529911041259766, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9386248588562012, 0.024726923555135727, 0.0366482213139534], "ptr_extra_sum_hist": [0.44762372970581055, 0.22254233062267303, 0.3298340141773224, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 500, "train_loss": 3.7629685401916504, "sliding_window_blocks": 7, "pointer_mask": {"enab
led": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0},
 "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0
.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": tru
e, "k": 1, "tau": 1.0}}, "delta_star_max_active": 19935, "kv_unique_blocks": {"mean": 5.318668619791667, "p50": 6, "p90"
: 9, "min": 1, "max": 18}, "ptr_outside_local_frac": {"mean": 0.1885543316602707, "min": 0.146484375, "max": 0.209337025
8808136}, "ptr_center_block0_frac": {"mean": 0.001953125, "min": 0.001953125, "max": 0.001953125}, "ptr_center_block0_fr
ac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.58524489402771, "min": 0.5490180253982544, "max": 0.620469868183136}, "ptr_radius0_frac": {"mean": 0.9386900067329407, "min": 0.9375813603401184, "max": 0.939805805683136}, "pi_entropy_mean": {"mean": 0.5386276245117188, "min": 0.3704114556312561, "max": 0.7968790531158447}, "reg": {"omega": 1.1524455695299807e-10, "entropy": 0.0002521332644391805, "delta_edge": 1.9102268197457306e-05, "zero_mean": 0.010600598528981209, "total": 0.010871834121644497}, "delta_tokens_hist": [0.325126588344574, 0.07776331156492233, 0.016035517677664757, 0.03554868325591087, 0.10420102626085281, 0.05190972238779068, 0.051484737545251846, 0.06301902234554291, 0.1058756485581398, 0.16903573274612427, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.4028899073600769, 0.016035517677664757, 0.03554868325591087, 0.10420102626085281, 0.05190972238779068, 0.051484737545251846, 0.06301902234554291, 0.1058756485581398, 0.16903573274612427, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.001953125, 0.001953125, 0.005027488339692354, 0.01008572056889534, 0.01673177070915699, 0.03316695615649223, 0.06407877802848816, 0.1214735209941864, 0.24552950263023376, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9386899471282959, 0.024596715345978737, 0.03671332448720932], "ptr_extra_sum_hist": [0.448209673166275, 0.22137045860290527, 0.3304199278354645, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 600, "train_loss": 3.626397132873535, "sliding_window_blocks": 9, "pointer_mask": {"enabled": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 23110, "kv_unique_blocks": {"mean": 4.85498046875, "p50": 5, "p90": 8, "min": 1, "max": 16}, "ptr_outside_local_frac": {"mean": 0.146545872092247, "min": 0.1233723983168602, "max": 0.2005750834941864}, "ptr_center_block0_frac": {"mean": 0.006696687545627356, "min": 0.0056966147385537624, "max": 0.008165148086845875}, "ptr_center_block0_frac_excl": {"mean": 0.0011355351889505982, "min": 0.0008748906548134983, "max": 0.0016404199413955212}, "ptr_center_docstart_frac": {"mean": 0.6404116749763489, "min": 0.5754936933517456, "max": 0.7550998330116272}, "ptr_radius0_frac": {"mean": 0.9381456971168518, "min": 0.9371473789215088, "max": 0.940185546875}, "pi_entropy_mean": {"mean": 0.5169715285301208, "min": 0.3658958375453949, "max": 0.710877001285553}, "reg": {"omega": 1.1586384629502788e-10, "entropy": 0.0002591418451629579, "delta_edge": 1.4770244888495654e-05, "zero_mean": 0.002800863469019532, "total": 0.003074775915592909}, "delta_tokens_hist": [0.2970522344112396, 0.06684932112693787, 0.025229671970009804, 0.03394097089767456, 0.09196686744689941, 0.07051143050193787, 0.0580240860581398, 0.06551468372344971, 0.08354853838682175, 0.20736218988895416, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.3639015555381775, 0.025229671970009804, 0.03394097089767456, 0.09196686744689941, 0.07051143050193787, 0.0580240860581398, 0.06551468372344971, 0.08354853838682175, 0.20736218988895416, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.006696686614304781, 0.0008192274253815413, 0.0015444154851138592, 0.00779079832136631, 0.01439887098968029, 0.033722151070833206, 0.06361400336027145, 0.12840530276298523, 0.2477521002292633, 0.4952564239501953, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9381455779075623, 0.02459309808909893, 0.03726128488779068], "ptr_extra_sum_hist": [0.44331055879592896, 0.22133789956569672, 0.3353515863418579, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 700, "train_loss": 3.5582680702209473, "sliding_window_blocks": 10, "pointer_mask": {"ena
bled": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}
, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp":
0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 26284, "kv_unique_blocks": {"mean": 5.008756510416666, "p50": 5, "p90": 8, "min": 1, "max": 17}, "ptr_outside_local_frac": {"mean": 0.16987667977809906, "min": 0.1424967497587204, "max": 0.2138400673866272}, "ptr_center_block0_frac": {"mean": 0.001953125, "min": 0.001953125, "max": 0.001953125}, "ptr_center_block0_frac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.6382343173027039, "min": 0.580810546875, "max": 0.710205078125}, "ptr_radius0_frac": {"mean": 0.9378635287284851, "min": 0.935302734375, "max": 0.9395073652267456}, "pi_entropy_mean": {"mean": 0.5191707611083984, "min": 0.35782378911972046, "max": 0.8412686586380005}, "reg": {"omega": 1.2062620347030872e-10, "entropy": 0.0002571394434198737, "delta_edge": 1.0850296348507982e-05, "zero_mean": 0.0016675812657922506, "total": 0.0019355711992830038}, "delta_tokens_hist": [0.306083619594574, 0.05657009407877922, 0.016527416184544563, 0.03882378339767456, 0.10077401250600815, 0.06625252962112427, 0.054456017911434174, 0.05996455252170563, 0.07660951465368271, 0.22393843531608582, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.3626537024974823, 0.016527416184544563, 0.03882378339767456, 0.10077401250600815, 0.06625252962112427, 0.054456017911434174, 0.05996455252170563, 0.07660951465368271, 0.22393843531608582, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.001953125, 0.008798104710876942, 0.001777705387212336, 0.0030960647854954004, 0.019229238852858543, 0.027645761147141457, 0.07415726035833359, 0.11334273219108582, 0.2560456395149231, 0.4939543604850769, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9378634691238403, 0.024985531345009804, 0.03715096786618233], "ptr_extra_sum_hist": [0.44077152013778687, 0.22486980259418488, 0.33435875177383423, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 800, "train_loss": 3.474344253540039, "sliding_window_blocks": 11, "pointer_mask": {"enabled": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 29458, "kv_unique_blocks": {"mean": 5.11318359375, "p50": 5, "p90": 8, "min": 1, "max": 17}, "ptr_outside_local_frac": {"mean": 0.17126919329166412, "min": 0.1341688334941864, "max": 0.2124837189912796}, "ptr_center_block0_frac": {"mean": 0.007765480782836676, "min": 0.006618923507630825, "max": 0.009060329757630825}, "ptr_center_block0_frac_excl": {"mean": 0.0022090990096330643, "min": 0.0017224409384652972, "max": 0.0028160542715340853}, "ptr_center_docstart_frac": {"mean": 0.6270471811294556, "min": 0.5503200888633728, "max": 0.7113444209098816}, "ptr_radius0_frac": {"mean": 0.9382361173629761, "min": 0.937364399433136, "max": 0.9390462040901184}, "pi_entropy_mean": {"mean": 0.5500862002372742, "min": 0.3528473377227783, "max": 0.7210507392883301}, "reg": {"omega": 1.183437792207087e-10, "entropy": 0.00021217335597611964, "delta_edge": 7.18084129402996e-06, "zero_mean": 0.0020642317831516266, "total": 0.0022835861891508102}, "delta_tokens_hist": [0.3022931218147278, 0.06311487406492233, 0.013223379850387573, 0.04533781856298447, 0.09512984752655029, 0.07306496053934097, 0.05793004855513573, 0.05564778670668602, 0.06400824338197708, 0.23024992644786835, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.3654079735279083, 0.013223379850387573, 0.04533781856298447, 0.09512984752655029, 0.07306496053934097, 0.05793004855513573, 0.05564778670668602, 0.06400824338197708, 0.23024992644786835, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.007765480317175388, 0.0008662471082061529, 0.0016456886660307646, 0.0065863714553415775, 0.014386212453246117, 0.04252025485038757, 0.05122974514961243, 0.1286820024251938, 0.2532009482383728, 0.4931170344352722, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9382359981536865, 0.024965638294816017, 0.03679832071065903], "ptr_extra_sum_hist": [0.44412437081336975, 0.2246907651424408, 0.33118492364883423, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 900, "train_loss": 3.3477909564971924, "sliding_window_blocks": 13, "pointer_mask": {"ena
bled": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}
, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp":
0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 32633, "kv_unique_blocks": {"mean": 4.958935546875, "p50": 5, "p90": 8, "min": 1, "max": 16}, "ptr_outside_local_frac": {"mean": 0.15732604265213013, "min": 0.131130650639534, "max": 0.1995171457529068}, "ptr_center_block0_frac": {"mean": 0.001953125, "min": 0.001953125, "max": 0.001953125}, "ptr_center_block0_frac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.6412833333015442, "min": 0.5746256709098816, "max": 0.73583984375}, "ptr_radius0_frac": {"mean": 0.9381656050682068, "min": 0.9363335371017456, "max": 0.9401041865348816}, "pi_entropy_mean": {"mean": 0.7039255499839783, "min": 0.44656819105148315, "max": 0.888094425201416}, "reg": {"omega": 1.1590341186806796e-10, "entropy": 7.177361112553626e-05, "delta_edge": 3.4363820304861292e-06, "zero_mean": 0.00040905189234763384, "total": 0.0004842620110139251}, "delta_tokens_hist": [0.2875126600265503, 0.06673719733953476, 0.017466001212596893, 0.04816804081201553, 0.0910373255610466, 0.07930772751569748, 0.055850330740213394, 0.052947770804166794, 0.06078558787703514, 0.24018734693527222, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.35424983501434326, 0.017466001212596893, 0.04816804081201553, 0.0910373255610466, 0.07930772751569748, 0.055850330740213394, 0.052947770804166794, 0.06078558787703514, 0.24018734693527222, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.001953125, 0.01075846329331398, 0.0019169560400769114, 0.0034722222480922937, 0.034138090908527374, 0.018171295523643494, 0.07432182878255844, 0.10526800900697708, 0.25, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9381654858589172, 0.024927660822868347, 0.03690682724118233], "ptr_extra_sum_hist": [0.44348961114883423, 0.2243489772081375, 0.33216148614883423, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "SCOPE_STATS", "step": 1000, "train_loss": 3.3674068450927734, "sliding_window_blocks": 14, "pointer_mask": {"enabled": true, "half_blocks": 2, "global_blocks": 0}, "pointer_reset": {"enabled": false, "reset_len": 0, "p_active": 0.0}, "pointer_cfg": {"local_blocks": 6, "half_blocks_max": 2, "budget_blocks": 64, "budget_is_total": true, "budget_temp": 0.5, "radius_mode": "pi", "global_blocks_max": 2, "qblock_rep": "last", "doc_clamp": true, "gumbel_topk": {"enabled": true, "k": 1, "tau": 1.0}}, "delta_star_max_active": 35807, "kv_unique_blocks": {"mean": 4.943863932291666, "p50": 5, "p90": 8, "min": 1, "max": 15}, "ptr_outside_local_frac": {"mean": 0.15054255723953247, "min": 0.1189236119389534, "max": 0.1962619423866272}, "ptr_center_block0_frac": {"mean": 0.001953125, "min": 0.001953125, "max": 0.001953125}, "ptr_center_block0_frac_excl": {"mean": 0.0, "min": 0.0, "max": 0.0}, "ptr_center_docstart_frac": {"mean": 0.642910897731781, "min": 0.5662977695465088, "max": 0.7488064169883728}, "ptr_radius0_frac": {"mean": 0.9381691813468933, "min": 0.936279296875, "max": 0.9396430253982544}, "pi_entropy_mean": {"mean": 0.7681360244750977, "min": 0.5756436586380005, "max": 1.0514307022094727}, "reg": {"omega": 1.1518862946813258e-10, "entropy": 1.973560756596271e-05, "delta_edge": 2.8124343742774727e-08, "zero_mean": 0.0001661430869717151, "total": 0.00018590694526210427}, "delta_tokens_hist": [0.2797688841819763, 0.07248987257480621, 0.017473233863711357, 0.05055700242519379, 0.08930302411317825, 0.08195529133081436, 0.05885235592722893, 0.0507269948720932, 0.05812174454331398, 0.09419849514961243, 0.14655309915542603, 0.0, 0.0, 0.0, 0.0, 0.0], "delta_blocks_hist": [0.35225874185562134, 0.017473233863711357, 0.05055700242519379, 0.08930302411317825, 0.08195529133081436, 0.05885235592722893, 0.0507269948720932, 0.05812174454331398, 0.09419849514961243, 0.14655309915542603, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_center_blocks_hist": [0.001953125, 0.004418041091412306, 0.0014413339085876942, 0.0078125, 0.01815863698720932, 0.03120117075741291, 0.06001519039273262, 0.12871094048023224, 0.2579571604728699, 0.4883318841457367, 0.0, 0.0, 0.0, 0.0, 0.0], "ptr_radius_hist": [0.9381691217422485, 0.02505967766046524, 0.03677119314670563], "ptr_extra_sum_hist": [0.4435221552848816, 0.22553712129592896, 0.33094078302383423, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "teacher_ran": false, "teacher_skip_reason": "not_time", "n_valid_q": 0, "n_valid_blocks": 0, "n_pos": 0, "n_neg": 0, "teacher_nce_used": false, "teacher_nce_pos_used": 0, "teacher_nce_neg_used": 0, "teacher_target_entropy": 0.0, "teacher_top1_mass": 0.0, "teacher_stats_step": 0}


{"tag": "NEEDLE_EVAL", "step": 1000, "seq_len": 131072, "anchor_len": 4, "value_len": 8, "samples_per_distance": 8, "sliding_window_blocks": 14, "pointer_mask": {"enabled": true, "half_blocks": 2}, "results": {"4096": {"dist_blocks": 32, "loss": 11.460007667541504, "ppl": 94845.79749621848, "token_acc": 0.0, "exact_match": 0.0}, "8192": {"dist_blocks": 64, "loss": 12.280571699142456, "ppl": 215468.86478726732, "token_acc": 0.0, "exact_match": 0.0}, "16384": {"dist_blocks": 128, "loss": 12.032238125801086, "ppl": 168087.19234451305, "token_acc": 0.0, "exact_match": 0.0}, "32768": {"dist_blocks": 256, "loss": 11.87273097038269, "ppl": 143305.0666855388, "token_acc": 0.0, "exact_match": 0.0}}, "overall": {"loss": 11.911387115716934, "ppl": 148953.15145421005, "token_acc": 0.0, "exact_match": 0.0}}